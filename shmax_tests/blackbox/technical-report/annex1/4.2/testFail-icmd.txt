error: expected a device function